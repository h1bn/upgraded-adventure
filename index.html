<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<script src="jquery-3.1.1.min.js"></script>
	<script src="utils.js"></script>
	<script src="rules.js"></script>
</head>
<body>
	<noscript>Scripts are disabled.</noscript>

	<div id="tab_combat">Combat</div>
	<div id="tab_other">Other</div>
	<!-- TODO: spells,build info (feats chosen per level), active buffs/debuffs, export/import -->

	<div id="content_combat"></div>
	<div id="content_other"></div>
	
	<script>
		// values of player's choice
		var stats = {};
		stats.classes = "Cleric 9";
		stats.HD = [8,6,8,6,6,8,5,8,3];
		stats.clvl = 9;
		
		stats.STR= 13;
		stats.DEX= 17;
		stats.CON= 10;
		stats.INT= 8;
		stats.WIS= 15;
		stats.CHA= 8;
		
		stats.BAB = "BAB_3_4(stats.clvl)";
		stats.FOR = "SAVE_GOOD(stats.clvl)";
		stats.REF = "SAVE_POOR(stats.clvl)";
		stats.WIL = "SAVE_GOOD(stats.clvl)";
		stats.skillsPerLevel = 2;

		stats.skillranks = {
			diplomacy: 1,
			heal: 1,
			knowledge_arcana: 1,
			knowledge_history: 1,
			knowledge_nobility: 1,
			knowledge_planes: 1,
			knowledge_religion: 1,
			perception: 9,
			sense_motive: 1,
			spellcraft: 1,
			stealth: 8,
			survival: 1
		}

		/* missing input:
			selected domains
			selected deity
			selected feats
			selected traits
			replaced class/race feats
			class skills
			conditional bonuses
			attacks / weapons
		*/


		stats.adjustments = [
			{
				data: ["CON-2", "INT+2", "DEX+2"],
				type: "",
				source: "Ability Score Racial Traits",
				availability: "constant"
			},
			{
				data: ["DEX+1", "WIS+1"],
				type: "",
				source: "Advancement (Levels 4,8)",
				availability: "constant"
			},
			{
				data: ["SKILLRANKS+9"],
				type: "",
				source: "Favored Class Bonus (Levels 1-9)",
				availability: "constant"
			},
			{
				data: [
					"cs_appraise +3",
					"cs_craft +3",
					"cs_diplomacy +3",
					"cs_heal +3",
					"cs_knowledge_arcana +3",
					"cs_knowledge_history +3",
					"cs_knowledge_nobility +3",
					"cs_knowledge_planes +3",
					"cs_knowledge_religion +3",
					"cs_linguistics +3",
					"cs_profession +3",
					"cs_sense_motive +3",
					"cs_spellcraft 3"
				],
				type: "",
				source: "Class Skills (Cleric)",
				availability: "constant"
			},
			{
				data: ["ATK+3", "DMG+3"], // TODO: clvl based values
				type: "luck",
				source: "Divine Favor",
				availability: "off"
			},
			{
				data: ["DEX+2"],
				type: "enhancement",
				source: "Belt of Incredible Dexterity",
				availability: "item" // TODO: item slots (overview / slot usage)
			},
			{
				data: ["cs_stealth +3", "stealth +1"], // TODO: conditional extra +1
				type: "trait",
				source: "Highlander (Trait)",
				availability: "constant"
			},
			{
				data: ["stealth +5"],
				type: "competence",
				source: "Cloak of Elvenkind",
				availability: "item"
			},
			{
				data: ["ATK+1", "DMG+1"],
				type: "enhancement",
				source: "Composite Longbow +1 holy",
				availability: "item"
			}
		];

		// other values
		stats.totalSTR = applyAdjustments(stats.STR, "STR");
		stats.totalDEX = applyAdjustments(stats.DEX, "DEX");
		stats.totalCON = applyAdjustments(stats.CON, "CON");
		stats.totalINT = applyAdjustments(stats.INT, "INT");
		stats.totalWIS = applyAdjustments(stats.WIS, "WIS");
		stats.totalCHA = applyAdjustments(stats.CHA, "CHA");

		stats.totalATK = applyAdjustments(0, "ATK");

		stats.testValue = SPELLS_PER_DAY_PREPARED_FULLCASTER(stats.clvl)[1];
		stats.testToHitRanged = val(stats.BAB) + STAT_MOD(stats.totalDEX) + stats.totalATK;

		stats.hitpoints = SUM_HD(stats.HD,stats.totalCON);

		stats.skills = {};

		calculateSkill("stealth", "DEX");

		

		$("#tab_combat").click(function() {
			$("#content_other").hide();
			$("#content_combat").show();
		});
		$("#tab_other").click(function() {
			$("#content_combat").hide();
			$("#content_other").show();
		});

		function showCombatStats() {
			var parent = $("#content_combat")
			
			createDisplayElem("classes", parent);
			createDisplayElem("hitpoints", parent);
			createDisplayElem("BAB", parent);
			createDisplayElem("totalSTR", parent);
			createDisplayElem("totalDEX", parent);
			createDisplayElem("totalCON", parent);
			createDisplayElem("totalINT", parent);
			createDisplayElem("totalWIS", parent);
			createDisplayElem("totalCHA", parent);
			createDisplayElem("testValue", parent);
			createDisplayElem("testToHitRanged", parent);
			createDisplayElem("",parent);
			console.log("stealth: "+stats.skills.stealth);
			
			//createSpellsElem(parent);

		}

		showCombatStats();
	</script>

</body>
</html>
